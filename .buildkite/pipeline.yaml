steps:
  - label: "Deploy Nginx to Kubernetes"
    commands:
      - echo "Deploying Nginx to Kubernetes"
      - kubectl apply -f k8s/deployment.yaml
      - kubectl apply -f k8s/service-account.yaml  
      - kubectl apply -f k8s/service.yaml
      - kubectl rollout status deployment/nginx --timeout=300s
    agents:
      queue: kubernetes
    plugins:
      - kubernetes:
          manifests:
            - ../k8s/deployment.yaml
            - ../k8s/service-account.yaml
            - ../k8s/service.yaml
          wait: true
          waitTimeout: 300
          waitInterval: 5
